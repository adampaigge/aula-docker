sudo: required
services:
- docker
language: c
env:
  global:
  - secure: "Y2MMQ95/hvQd88icsJveuAL2/kBmtJV9e/AQGhQ/EAsJflWwKbV489wiI5pjOsNO1+DN8hPqaNYezY3Ym8d2wihcNFJ2I379kpzPND+aHyNAODgbTcTPKk7pzdIlKNDKdX5ObQTO62OnuvLr126p+Yv4gFJ3nyWSLWQA5NmO3wPVRMYWCTjAMhMuImwAPwOAxDfKcEKWYxh5aAWlxcSxXVH2rgIAgT6L0zElvM4g//WlHCGiGnmfaJ6Va3V6cToyo1K3WW1Sub9AA57fWJk0MIldv1qn0ReOIq5xOf0yANOBRkC98RCNU2iQ4j6J4QUU0ynWRghy+eS9CRz0ZMjc1FUNLJlWzjlBHYqIb4sgcAZ5k1kJCM2VojGZHz4CLhBdNAL+e4NTnmZBlnwbTNuhUkj/fxsYCf9W6q0qnYw0gUWvjVHnh1V7sNToRGM2p0XwVGTsi4fgnZSZJv9Kb5L2j7AxgCkq9luAE9q6z4rxzgH24Xq2SsLwiH97+rktaM6THGryg9q1eAlhbzHs81q3UErhPfym5sEyeN8Ry6AdOm/f6QLQfi2cdq9P+SB3J3eMNWoYNk/DSCaw0/Ebwv+q4DwXnFiO4BRM5uJhyu/a0MGJkbGfkSbnLjw9sytT+b7R/LU+rEfTwto484KiXWsrFmJDYH2E/td5nw580ci03/I=" # DOCKER_EMAIL
  - secure: "qLSyGXY+k9nQmPqkljqQq1p2dF2XgSVlwQsemglwTjiGcU6bvzmlIYUKgI2PsdfkrYfGy4BbtRd/iGhB/RUzLLMdMwEeBN7xLibMWk1iZErow12vqK6IJK6VqGzcIPt1cRYotgqeVk15wRY6hfAxKAcHVzc9dgzpV2ywQgH/rygEwSkjWUnD6BmVTMdqrvYHby7OTvD5/BoXdIZVcoVPU8x4eYRiV++G/taUL+7imfwsrl3ZqatFHa8zi8/2WhWlcQcu1O3uAMhssNa5o3g4X7jubr6gvXlAUR7viDT5b9TkdnVSZ2v7qhTCs8yS4j+7LqTJuB0tNmIizosypfTdRJyY97uqviYv4lXx0ygdqXy9Srs8zAtvTYBEQKr91COZHWMSpoiroQtmGnMmAIkxfQmuGzLH8PrirZBYWzDmk0lzeh0EuUgvxQGZgWjTPQD9VZfEgNMmVGcECWBbx/FFEiKf5BAWzH7gf5101EqcqRtiD3Aca40Mqw+CCbLttWuxaBqpJ26nd+NeyTehaQ/Kf5nKj/JFapcGcY+Bvjo7XDrfyRqhKs73dmNVqHra8vQVLX+yAbLIgE2Ew5vkFdhscvS2SaKE3ht2pTCckwTXLDVUV3Moee0KcfusQykTFwiqXkrE2QaycKaL49rskWs4MmrF8VmhHF2G4K5FImZJ4do=" # DOCKER_USERNAME
  - secure: "yg413Si+i/fvAzeQkyJUk+A7shGTfLddaeD3dpqikYCXfGaSBh1rXkVQm0yDHCsADdLlsnh+KnwxQxlw4NAJFLdI5BjoA0Gp6y4WKnf8I63wvV8mqsowqlzCwemCAYHjE10MoAPpw92lkHkeePG07AsUwRBLJ6pLGVX7zJbl7svqWEhAFaabDjwHERAkCPGBYgm1ngPNeFImXoWBGH80jIbQj9ywIPl/X36LnxoFJPldR14HyzC35rlaR18Mf4cK9ztHUQSwBOJNER+VmeErf6oqG9QgPoSEhv7+uQvaS35Vxrg1haDmHcVcQ9smfeRhw+hWg1D1k+kFW85XVyGRcUBo31O0c+1H7LCXv7HWiL7ehfI76v5mRLIP4/Xe40FmJeJH3xeuB5gfbWQIKjMCT6anR++++ipSY7r6XNLrI7QzMQiePjtVRzfAPZI7JUDvEAa9bDwTGgOZAib7uvVKEnGbuY0Bpj7FK89fC3yQ2ZcC8ISr+A+yuJoTptUZvaI8whLlv1oP0ABy9GBkztr6ylDl8y+hW44hRomQZSJrrVuFC4mzvFGtVzHrb//Zu8oMBWLBmPr9/bpffU8/Ha4BR1evRLcYF+V/h69+Qc+orJcYp4RBM0w2vdHhQ1bnMrCNeS1Z0YQJhST5AWOc06tuo7pHmndNqAR0+v1CuXymibI=" # DOCKER_PASS
  - COMMIT=${TRAVIS_COMMIT::8}
script:
  - git submodule update --init --recursive
  - docker login -e $DOCKER_EMAIL -u $DOCKER_USERNAME -p $DOCKER_PASS
  - export REPO=fisx/aula
  - export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; else echo $TRAVIS_BRANCH ; fi`
  - docker build -f Dockerfile -t $REPO:$COMMIT .
  - docker tag $REPO:$COMMIT $REPO:$TAG
  - docker push $REPO
